{"version":3,"sources":["admin.js"],"names":["init","$","post","action","showGoods","data","JSON","parse","out","id","hasOwnProperty","name","val","html","on","selectGoods","attr","gid","cost","description","img","bigdesc","saveToDb","gname","gcost","gdesc","gimg","gbigdesc","alert","console","log","delFromDb","document","ready"],"mappings":"AAAA,SAASA,OACLC,EAAEC,KACE,WACA,CACIC,OAAU,QAEdC,WAIR,SAASA,UAAUC,GACfA,EAAOC,KAAKC,MAAMF,GAClB,IAAIG,EAAM,WAEV,IAAK,IAAIC,KADTD,GAAO,6CACQH,EACNA,EAAKK,eAAeD,KACzBD,GAAO,mBAAqBC,EAAK,IAAMJ,EAAKI,GAAIE,KAAO,aAE3DH,GAAO,YACPP,EAAE,SAASW,IAAI,IACfX,EAAE,YAAYW,IAAI,IAClBX,EAAE,cAAcY,KAAKL,GACrBP,EAAE,qBAAqBa,GAAG,SAAUC,aAGxC,SAASA,cACL,IAAIN,EAAKR,EAAE,qCAAqCe,KAAK,WACrDf,EAAEC,KACE,WACA,CACIC,OAAU,iBACVc,IAAOR,GAEX,SAAUJ,GACNA,EAAOC,KAAKC,MAAMF,GAClBJ,EAAE,UAAUW,IAAIP,EAAKM,MACrBV,EAAE,UAAUW,IAAIP,EAAKa,MACrBjB,EAAE,UAAUW,IAAIP,EAAKc,aACrBlB,EAAE,SAASW,IAAIP,EAAKe,KACpBnB,EAAE,QAAQW,IAAIP,EAAKI,IACnBR,EAAE,aAAaW,IAAIP,EAAKgB,WAKpC,SAASC,WACL,IAAIb,EAAKR,EAAE,QAAQW,MACR,KAAPH,EACAR,EAAEC,KACE,WACA,CACIC,OAAU,cACVM,GAAMA,EACNc,MAAStB,EAAE,UAAUW,MACrBY,MAASvB,EAAE,UAAUW,MACrBa,MAASxB,EAAE,UAAUW,MACrBc,KAAQzB,EAAE,SAASW,MACnBe,SAAY1B,EAAE,aAAaW,OAE/B,SAAUP,GACM,qBAARA,GACAuB,MAAM,cACN5B,QAEA6B,QAAQC,IAAIzB,KAKxBJ,EAAEC,KACE,WACA,CACIC,OAAU,WACVM,GAAM,EACNc,MAAStB,EAAE,UAAUW,MACrBY,MAASvB,EAAE,UAAUW,MACrBa,MAASxB,EAAE,UAAUW,MACrBc,KAAQzB,EAAE,SAASW,MACnBe,SAAY1B,EAAE,aAAaW,OAE/B,SAAUP,GACM,kBAARA,GACAuB,MAAM,oBACN5B,QAEA6B,QAAQC,IAAIzB,KAOhC,SAAS0B,YACL,IAAItB,EAAKR,EAAE,QAAQW,MACR,KAAPH,EACAR,EAAEC,KACE,WACA,CACIC,OAAU,cACVM,GAAMA,GAEV,SAAUJ,GACM,qBAARA,GACAuB,MAAM,YACN5B,QAEA6B,QAAQC,IAAIzB,KAKxBuB,MAAM,kBAId3B,EAAE+B,UAAUC,MAAM,WACdjC,OACAC,EAAE,cAAca,GAAG,QAASQ,UAC5BrB,EAAE,gBAAgBa,GAAG,QAASiB","file":"admin.js","sourcesContent":["function init() { // обращение в базу данных\r\n    $.post(\r\n        \"core.php\",\r\n        {\r\n            \"action\": \"init\"\r\n        },\r\n        showGoods\r\n    );\r\n}\r\n\r\nfunction showGoods(data) {//формирование выпадающего списка товаров\r\n    data = JSON.parse(data);\r\n    var out = \"<select>\";\r\n    out += \"<option data-id =\\\"0\\\">Новая пицца </option>\";\r\n    for (var id in data) {\r\n        if (!data.hasOwnProperty(id)) continue;\r\n        out += \"<option data-id=\" + id + \">\" + data[id].name + \"</option>\";\r\n    }\r\n    out += \"</select>\";\r\n    $(\"input\").val(\"\");\r\n    $(\"textarea\").val(\"\");\r\n    $(\".goods-out\").html(out);\r\n    $(\".goods-out select\").on(\"change\", selectGoods);\r\n}\r\n\r\nfunction selectGoods() { // заполнение полей ввода данными из базы данных по каждому товару\r\n    var id = $(\".goods-out select option:selected\").attr(\"data-id\");\r\n    $.post(\r\n        \"core.php\",\r\n        {\r\n            \"action\": \"selectOneGoods\",\r\n            \"gid\": id\r\n        },\r\n        function (data) {\r\n            data = JSON.parse(data);\r\n            $(\"#gName\").val(data.name);\r\n            $(\"#gCost\").val(data.cost);\r\n            $(\"#gDesc\").val(data.description);\r\n            $(\"#gImg\").val(data.img);\r\n            $(\"#gId\").val(data.id);\r\n            $(\"#gBigDesc\").val(data.bigdesc);\r\n        }\r\n    );\r\n}\r\n\r\nfunction saveToDb() { // Сохранение новго или обновленного товара в базу данных\r\n    var id = $(\"#gId\").val();\r\n    if (id !== \"\") { //обновление существующего товара\r\n        $.post(\r\n            \"core.php\",\r\n            {\r\n                \"action\": \"updateGoods\",\r\n                \"id\": id,\r\n                \"gname\": $(\"#gName\").val(),\r\n                \"gcost\": $(\"#gCost\").val(),\r\n                \"gdesc\": $(\"#gDesc\").val(),\r\n                \"gimg\": $(\"#gImg\").val(),\r\n                \"gbigdesc\": $(\"#gbigdesc\").val()\r\n            },\r\n            function (data) {\r\n                if (data == \"Update successful\") {\r\n                    alert(\"Сохранено!\");\r\n                    init();\r\n                } else {\r\n                    console.log(data);\r\n                }\r\n            }\r\n        )\r\n    } else { // добавление нового товара\r\n        $.post(\r\n            \"core.php\",\r\n            {\r\n                \"action\": \"newGoods\",\r\n                \"id\": 0,\r\n                \"gname\": $(\"#gName\").val(),\r\n                \"gcost\": $(\"#gCost\").val(),\r\n                \"gdesc\": $(\"#gDesc\").val(),\r\n                \"gimg\": $(\"#gImg\").val(),\r\n                \"gbigdesc\": $(\"#gbigdesc\").val()\r\n            },\r\n            function (data) {\r\n                if (data == \"Add successful\") {\r\n                    alert(\"Поле добавлено!!\");\r\n                    init();\r\n                } else {\r\n                    console.log(data);\r\n                }\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nfunction delFromDb() { // Удаление из базы данных товара\r\n    var id = $(\"#gId\").val();\r\n    if (id !== \"\") {\r\n        $.post(\r\n            \"core.php\",\r\n            {\r\n                \"action\": \"deleteGoods\",\r\n                \"id\": id\r\n            },\r\n            function (data) {\r\n                if (data == \"Delete successful\") {\r\n                    alert(\"Удалено!\");\r\n                    init();\r\n                } else {\r\n                    console.log(data);\r\n                }\r\n            }\r\n        )\r\n    } else {\r\n        alert(\"Удалять нечего\");\r\n    }\r\n}\r\n\r\n$(document).ready(function () { //инициализация страницы\r\n    init();\r\n    $(\"#add-to-db\").on(\"click\", saveToDb);\r\n    $(\"#del-from-db\").on(\"click\", delFromDb);\r\n});"]}