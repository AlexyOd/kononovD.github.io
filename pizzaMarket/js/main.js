var basket={};function init(){$.post("/core.php",{action:"loadGoods"},goodsOut)}function goodsOut(a){var s="";if(0!=(a=JSON.parse(a)))for(var t in a)a.hasOwnProperty(t)&&(s+='<div class="pizza__slide clearfix"><div class="pizza__text ">',s+='<h2 class="pizza__name">'+a[t].name+"  </h2>",s+='<p class="pizza__desc">'+a[t].description+"  </p>",s+='<p class="pizza__cost">Цена: '+a[t].cost+"  </p>",s+="<button data-id="+t+' class="choose-btn"><i class="fas fa-check"></i> Выбрать</button>',s+='</div><div class="pizza__img"><img src=img/'+a[t].img+' alt="Пицца"></div></div>');else s="<h1> Товаров нет! </h1>";$(".goods-out").html(s),$(".choose-btn").on("click",addToBasket)}function addToBasket(){isEmpty(basket)&&!$("#basket-toggle").prop("checked")&&$(".basket-btn").click();var a=$(this).attr("data-id");void 0===basket[a]?basket[a]=1:basket[a]++,showMiniBasket(),saveBasket()}function saveBasket(){localStorage.setItem("basket",JSON.stringify(basket))}function showMiniBasket(){isEmpty(basket)?$(".basket-out").html("<h3>Корзина пуста</h3>"):$.post("/core.php",{action:"loadGoods"},function(a){var s=0,t=a=JSON.parse(a),e='<div class=" pizza-out">';for(var i in basket)basket.hasOwnProperty(i)&&(e+='<div class="basket__pizza-wrap clearfix"><div class="basket__pizza-txt">',e+='<h3 class="basket__pizza-name">'+t[i].name+"</h3>",e+='<p class="basket__pizza-cost"><span class="basket__pizza-lower">Цена:</span>'+t[i].cost*basket[i],e+='<p class="basket__pizza-count"><span class="basket__pizza-lower">Количество:</span>'+basket[i]+"</p>",e+='<span data-id="'+i+'"  class="basket__pizza-plus"><i class="fas fa-plus"></i></span>',e+='<spsn data-id="'+i+'" class="basket__pizza-minus"><i class="fas fa-minus"></i></spsn>',e+='</div><div class="basket__pizza-img">',e+="<img src=img/"+t[i].img+' alt="Пицца"></div>',e+='<div  class="basket__pizza-del" data-id='+i+'><i class="fas fa-times"></i></div></div>',s+=t[i].cost*basket[i]);e+='</div><div class="order-form clearfix">',e+='<input type="email"  id="input-email" class="input-email" placeholder="E-mail">',e+='<input type="text"  id="input-name" class="input-name" placeholder="Имя">',e+='<input type="tel"  id="input-tel" class="input-tel" placeholder="Телефон">',e+='<p class="cost-of-all">Всего: '+s+" грн.</p>",e+='<button onclick="sendEmail()" id="sbm-btn" class="sbm-btn">Заказать</button></div>',$(".basket-out").html(e),$(".basket__pizza-del").on("click",delGoods),$(".basket__pizza-plus").on("click",plusGoods),$(".basket__pizza-minus").on("click",minusGoods)})}function delGoods(){var a=$(this).attr("data-id");delete basket[a],isEmpty(basket)&&$("#basket-toggle").prop("checked")&&$(".basket-btn").click(),saveBasket(),showMiniBasket()}function plusGoods(){var a=$(this).attr("data-id");basket[a]++,saveBasket(),showMiniBasket()}function minusGoods(){var a=$(this).attr("data-id");1===basket[a]?delete basket[a]:basket[a]--,isEmpty(basket)&&$("#basket-toggle").prop("checked")&&$(".basket-btn").click(),saveBasket(),showMiniBasket()}function isEmpty(a){for(var s in a)if(a.hasOwnProperty(s))return!1;return!0}function loadBasket(){localStorage.getItem("basket")&&(basket=JSON.parse(localStorage.getItem("basket")),showMiniBasket())}function sendEmail(){var a=$("#input-name").val(),s=$("#input-tel").val(),t=$("#input-email").val();validName(a)&&validEmail(t)&&validTel(s)&&(isEmpty(basket)?alert("Корзина пуста!"):$.post("mail.php",{name:a,email:t,tel:s,basket:basket},function(){alert("Заказ отправлен"),$(this).find("input").val(""),$(".order-form").trigger("reset")}))}function validEmail(a){return 1<a.indexOf("@")&&1<a.indexOf(".")||(alert("Неправильный e-mail!"),!1)}function validName(a){return 1<a.length&&-1==a.search(/\d/)||(alert("Некорректное Имя!"),!1)}function validTel(a){return 0==a.search(/\d/)&&-1==a.search(/[A-Z]/i)||(alert("Некорректный телефон!"),!1)}$(document).ready(function(){init(),loadBasket(),isEmpty(basket)||$(".basket-btn").click()});
//# sourceMappingURL=main.js.map
